---
title: "Chapter2_exponential"
output: html_document
date: "2025-11-02"
---




## Exponential analytical iE 

```{r}

set.seed(42)
require(latex2exp)
lambda <- 2

n <- 20

simulation_times <- 10000  #for single trial, just set simulation_times to be 1.

iteration_times <- 30
bootstrap_times <- 1

ite_mle <- matrix(0,nrow=simulation_times,ncol=iteration_times+1)
V <- matrix(0,nrow=simulation_times,ncol=iteration_times+1)
for(t in 1:simulation_times){
  
  sample_exp <- rexp(n,rate=lambda)
  mle <- 1/mean(sample_exp)
  #ite_mle <- c()
  ite_mle[t,1] <- mle

  for( i in 1:iteration_times){

    ite_mle[t,i+1] <- ite_mle[t,1]-ite_mle[t,i]/(n-1)
    
    
  }

}




plot(seq(1,iteration_times+1),colMeans(ite_mle),xlab=expression(paste('iteration times', ~k)),ylab=TeX("$\\hat{\\theta}_k$"))
abline(h=lambda,col='red')
abline(h=(n-1)*mean(ite_mle[,1])/n,col='blue')
legend('topright',legend=c('bias-corrected MLE','true lambda =2','iE'),col=c('blue','red','black'),lty=c(1,1,NA),pch=c(NA,NA,1))




```